(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["earning"],{"083a":function(e,t,n){"use strict";var a=n("0d51"),r=TypeError;e.exports=function(e,t){if(!delete e[t])throw new r("Cannot delete property "+a(t)+" of "+a(e))}},2383:function(e,t,n){},"5edb":function(e,t,n){"use strict";n("2383")},"7db0":function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").find,s=n("44d2"),c="find",u=!0;c in[]&&Array(1)[c]((function(){u=!1})),a({target:"Array",proto:!0,forced:u},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),s(c)},"9e39":function(e,t,n){"use strict";n.r(t);n("4de4"),n("d81d"),n("b0c0"),n("e9f5"),n("ab43"),n("d3b7");var a,r,s,c,u=function(){var e=this,t=e._self._c;return t("ValidationObserver",{ref:"refForm",staticClass:"form"},[t("div",{staticClass:"form-header"},[t("div",{staticClass:"has-button"},[t("h3",[e._v("Earning / Deduction")])]),t("p",[e._v("Please choose at least one earning group below")]),t("ul",{staticClass:"allowance-list"},e._l(e.earnDeductGroups,(function(n){return t("li",{key:n._id,staticClass:"allowance-list-item"},[t("p",{class:{"is-active":e.groupSelected===n._id},on:{click:function(t){return e.changeGroup(n._id)}}},[e._v(e._s(n.name))])])})),0)]),t("div",{staticClass:"form"},[t("div",{staticClass:"columns is-multiline"},e._l(e.allowances,(function(n){return t("div",{key:n._id,staticClass:"column is-6"},[t("div",{staticClass:"field"},[t("label",{staticClass:"label"},[e._v(" "+e._s(n.earnDeductId.name)+" ")]),t("ValidationProvider",{attrs:{name:n.earnDeductId.name,rules:"required"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.errors;return[t("currency-input",{staticClass:"input",attrs:{"allow-negative":!1,"value-range":{min:0},"distraction-free":!1,currency:{prefix:"",suffix:" LAK"},"value-as-integer":!0,precision:0,placeholder:"Enter default amount"},model:{value:n.amount,callback:function(t){e.$set(n,"amount",t)},expression:"i.amount"}}),t("p",{staticClass:"has-text-danger"},[e._v(e._s(r[0]))])]}}],null,!0)})],1)])})),0)]),e.customAllowances.length?t("div",{staticClass:"box"},[t("div",{staticClass:"form-header"},[t("h3",[e._v("Custom Earning / Deduction")]),t("p",[e._v("These Earning / Deduction will ...")])]),t("div",{staticClass:"form"},[e._l(e.customAllowances,(function(n,a){return t("div",{key:a,staticClass:"columns is-multiline"},[t("div",{staticClass:"column is-2 custom"},[t("div",{staticClass:"field"},[t("label",{staticClass:"label"},[e._v("Name")]),t("div",{staticClass:"contro"},[t("ValidationProvider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.errors;return[t("input",{directives:[{name:"model",rawName:"v-model",value:n.name,expression:"i.name"}],staticClass:"input",attrs:{type:"text",placeholder:"Enter name"},domProps:{value:n.name},on:{input:function(t){t.target.composing||e.$set(n,"name",t.target.value)}}}),t("p",{staticClass:"has-text-danger"},[e._v(e._s(r[0]))])]}}],null,!0)})],1)])]),t("div",{staticClass:"column is-3 custom"},[t("div",{staticClass:"field"},[t("label",{staticClass:"label"},[e._v("Amount")]),t("div",{staticClass:"contro"},[t("ValidationProvider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.errors;return[t("currency-input",{staticClass:"input",attrs:{"allow-negative":!1,"value-range":{min:0},"distraction-free":!1,currency:{prefix:"",suffix:""},"value-as-integer":!0,precision:0,placeholder:"Enter default amount"},model:{value:n.amount,callback:function(t){e.$set(n,"amount",t)},expression:"i.amount"}}),t("p",{staticClass:"has-text-danger"},[e._v(e._s(r[0]))])]}}],null,!0)})],1)])]),t("div",{staticClass:"column is-3 custom"},[t("div",{staticClass:"field"},[t("label",{staticClass:"label"},[e._v("Type")]),t("div",{staticClass:"control"},[t("div",{staticClass:"select"},[t("ValidationProvider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.errors;return[t("select",{directives:[{name:"model",rawName:"v-model",value:n.type,expression:"i.type"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(n,"type",t.target.multiple?a:a[0])}}},e._l(e.types,(function(n,a){return t("option",{key:a,domProps:{value:n}},[e._v(e._s(n))])})),0),t("p",{staticClass:"has-text-danger"},[e._v(e._s(r[0]))])]}}],null,!0)})],1)])])]),t("div",{staticClass:"column is-3 custom"},[t("div",{staticClass:"field"},[t("label",{staticClass:"label"},[e._v("TAX Calculation")]),t("div",{staticClass:"control"},[t("div",{staticClass:"select"},[t("ValidationProvider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.errors;return[t("select",{directives:[{name:"model",rawName:"v-model",value:n.isBeforeTax,expression:"i.isBeforeTax"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(n,"isBeforeTax",t.target.multiple?a:a[0])}}},[t("option",{domProps:{value:!0}},[e._v("Before TAX")]),t("option",{domProps:{value:!1}},[e._v("After TAX")])]),t("p",{staticClass:"has-text-danger"},[e._v(e._s(r[0]))])]}}],null,!0)})],1)])])]),t("div",{staticClass:"column is-1"},[t("div",{staticClass:"field"},[t("label",{staticClass:"label"},[e._v("Option")]),t("div",{staticClass:"control has-icon",on:{click:function(t){return e.spliceCustomAllo(a)}}},[t("i",{staticClass:"fas fa-trash"})])])])])})),e._v(" "),t("button",{staticClass:"button sub",attrs:{type:"button"},on:{click:e.addCustomAllo}},[e._v("Add ")])],2)]):e._e(),t("hr"),t("button",{staticClass:"button primary mt-2",attrs:{type:"button"},on:{click:e.saveOnly}},[e._v("Update")])])},o=[],i=n("c7eb"),l=n("1da1"),d=(n("7db0"),n("14d9"),n("a434"),n("f665"),n("e41e")),p=n("47b6"),m=n("8785"),f=n("5184"),v=Object(f["a"])(a||(a=Object(m["a"])(["    \n    query(\n        $employeeId: ID!\n    ) {\n        getAllowance(\n            employeeId: $employeeId\n        ) {\n            _id\n            earnDeductGroupId {\n                _id\n                name\n            }\n            allowances {\n                earnDeductId {\n                    _id\n                    name\n                    groups {\n                        _id\n                        name\n                    }\n                }\n                amount\n            }\n        }\n    }\n"]))),b=Object(f["a"])(r||(r=Object(m["a"])(["\n\n    mutation (\n        $employeeId: ID!\n        $earnDeductGroupId: ID!\n        $allowances: [AllowanceInput]!\n    ) {\n        addOrUpdateAllowance(\n            info: {\n                employeeId: $employeeId\n                earnDeductGroupId: $earnDeductGroupId\n                allowances: $allowances\n            }\n        ) {\n            _id\n            earnDeductGroupId {\n                _id\n                name\n            }\n            \n            allowances {\n                earnDeductId {\n                    _id\n                    name\n                }\n                amount\n            }\n        }\n    }\n\n"]))),h=function(e){return new Promise(function(){var t=Object(l["a"])(Object(i["a"])().mark((function t(n,a){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p["a"].mutate({mutation:v,variables:{employeeId:e}});case 3:r=t.sent,n(r.data.getAllowance),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),a(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}())},w=function(e){return new Promise(function(){var t=Object(l["a"])(Object(i["a"])().mark((function t(n,a){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p["a"].mutate({mutation:b,variables:e});case 3:r=t.sent,n(r.data.addOrUpdateAllowance),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),a(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}())},x=Object(f["a"])(s||(s=Object(m["a"])(["\n\n    query (\n        $employeeId: ID!\n    ) {\n        getCustomAllowance(\n            employeeId: $employeeId\n        ) {\n            _id\n            customAllowances {\n                type\n                name\n                isBeforeTax\n                amount\n            }\n        }\n    }\n\n"]))),O=Object(f["a"])(c||(c=Object(m["a"])(["\n\n    mutation(\n        $employeeId: ID!\n        $items: [CustomAlloItemsInput!]!\n    ) {\n        addOrUpdateCustomAllowance(\n            info: {\n                employeeId: $employeeId\n                items: $items\n            }\n        ) {\n            _id\n            customAllowances {\n                type\n                name\n                isBeforeTax\n                amount\n            }\n        }\n    }\n\n\n\n"]))),_=function(e){return new Promise(function(){var t=Object(l["a"])(Object(i["a"])().mark((function t(n,a){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p["a"].mutate({mutation:x,variables:{employeeId:e}});case 3:r=t.sent,n(r.data.getCustomAllowance),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),a(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}())},I=function(e){return new Promise(function(){var t=Object(l["a"])(Object(i["a"])().mark((function t(n,a){var r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p["a"].mutate({mutation:O,variables:e});case 3:r=t.sent,n(r.data.addOrUpdateCustomAllowance),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),a(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}())},y=n("f605"),g={data:function(){return{earnDeductGroups:[],groupSelected:"",allowances:[],fakes:[],customAlloId:"",customAllowances:[],types:["Earning","Deduction"]}},created:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getEarnDeductGroups();case 2:return t.next=4,e.getAllowance();case 4:return t.next=6,e.getCustomAllowance();case 6:case"end":return t.stop()}}),t)})))()},methods:{getEarnDeductGroups:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["c"])();case 2:e.earnDeductGroups=t.sent,e.changeGroup(e.earnDeductGroups[0]._id);case 4:case"end":return t.stop()}}),t)})))()},addOrUpdateAllowance:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n,a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$store.commit("SET_IS_LOADING",!0),n=e.allowances.map((function(e){return{earnDeductId:e.earnDeductId._id,amount:parseInt(e.amount)}})),a={earnDeductGroupId:e.groupSelected,employeeId:e.$route.params.id,allowances:n},t.prev=3,t.next=6,e.$store.dispatch("loading");case 6:return t.next=8,w(a);case 8:return t.next=10,e.$store.dispatch("completed");case 10:t.next=19;break;case 12:if(t.prev=12,t.t0=t["catch"](3),!t.t0.graphQLErrors[0]){t.next=19;break}return alert(t.t0.graphQLErrors[0].message),t.next=18,e.$store.dispatch("error");case 18:return t.abrupt("return");case 19:return t.next=21,e.addOrUpdateCustomAllowance();case 21:setTimeout((function(){e.$store.commit("SET_IS_LOADING",!1)}),y["b"]);case 22:case"end":return t.stop()}}),t,null,[[3,12]])})))()},saveAndContinue:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.refForm.validate();case 2:if(n=t.sent,n){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.addOrUpdateAllowance();case 7:return t.next=9,e.$router.push({name:"document",params:{id:e.$route.params.id}});case 9:case"end":return t.stop()}}),t)})))()},saveOnly:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.refForm.validate();case 2:if(n=t.sent,n){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.addOrUpdateAllowance();case 7:case"end":return t.stop()}}),t)})))()},getAllowance:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,h(e.$route.params.id);case 2:n=t.sent,e.changeGroup(n.earnDeductGroupId._id),e.allowances=n.allowances;case 5:case"end":return t.stop()}}),t)})))()},getCustomAllowance:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_(e.$route.params.id);case 2:n=t.sent,e.customAlloId=n._id,e.customAllowances=n.customAllowances.map((function(e){return{type:e.type,name:e.name,isBeforeTax:e.isBeforeTax,amount:parseInt(e.amount,10)}}));case 5:case"end":return t.stop()}}),t)})))()},addOrUpdateCustomAllowance:function(){var e=this;return Object(l["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={employeeId:e.$route.params.id,items:e.customAllowances?e.customAllowances.map((function(e){return{type:e.type,name:e.name,isBeforeTax:e.isBeforeTax,amount:parseInt(e.amount,10)}})):[]},t.next=3,I(n);case 3:case"end":return t.stop()}}),t)})))()},changeGroup:function(e){this.groupSelected=e;var t=this.earnDeductGroups.find((function(t){return t._id===e})).earnDeductIds;this.allowances=t.map((function(e){return{earnDeductId:{_id:e._id,name:e.name,groups:e.groups},amount:0}}))},addCustomAllo:function(){var e={name:"",amount:null,type:"Earning",isBeforeTax:!0};this.customAllowances.push(e)},spliceCustomAllo:function(e){this.customAllowances.splice(e,1)}}},C=g,j=(n("5edb"),n("2877")),D=Object(j["a"])(C,u,o,!1,null,"5886b292",null);t["default"]=D.exports},a434:function(e,t,n){"use strict";var a=n("23e7"),r=n("7b0b"),s=n("23cb"),c=n("5926"),u=n("07fa"),o=n("3a34"),i=n("3511"),l=n("65f0"),d=n("8418"),p=n("083a"),m=n("1dde"),f=m("splice"),v=Math.max,b=Math.min;a({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,a,m,f,h,w,x=r(this),O=u(x),_=s(e,O),I=arguments.length;for(0===I?n=a=0:1===I?(n=0,a=O-_):(n=I-2,a=b(v(c(t),0),O-_)),i(O+n-a),m=l(x,a),f=0;f<a;f++)h=_+f,h in x&&d(m,f,x[h]);if(m.length=a,n<a){for(f=_;f<O-a;f++)h=f+a,w=f+n,h in x?x[w]=x[h]:p(x,w);for(f=O;f>O-a+n;f--)p(x,f-1)}else if(n>a)for(f=O-a;f>_;f--)h=f+a-1,w=f+n-1,h in x?x[w]=x[h]:p(x,w);for(f=0;f<n;f++)x[f+_]=arguments[f+2];return o(x,O-a+n),m}})},ab43:function(e,t,n){"use strict";var a=n("23e7"),r=n("d024"),s=n("c430");a({target:"Iterator",proto:!0,real:!0,forced:s},{map:r})},d024:function(e,t,n){"use strict";var a=n("c65b"),r=n("59ed"),s=n("825a"),c=n("46c4"),u=n("c5cc"),o=n("9bdd"),i=u((function(){var e=this.iterator,t=s(a(this.next,e)),n=this.done=!!t.done;if(!n)return o(e,this.mapper,[t.value,this.counter++],!0)}));e.exports=function(e){return s(this),r(e),new i(c(this),{mapper:e})}},d81d:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").map,s=n("1dde"),c=s("map");a({target:"Array",proto:!0,forced:!c},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},e41e:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return h})),n.d(t,"d",(function(){return w})),n.d(t,"b",(function(){return x}));var a,r,s,c,u=n("c7eb"),o=n("1da1"),i=(n("d3b7"),n("47b6")),l=n("8785"),d=n("5184"),p=Object(d["a"])(a||(a=Object(l["a"])(["\n\n    {\n        getEarnDeductGroups {\n            _id\n            name\n            earnDeductsCount\n            earnDeductIds {\n                _id\n                name\n                groups {\n                    _id\n                    name\n                }\n            }\n        }\n    }\n\n"]))),m=Object(d["a"])(r||(r=Object(l["a"])(["\n\n    mutation (\n        $name: String!\n        $earnDeductIds: [ID]!\n    ) {\n        addEarnDeductGroup(\n            info: {\n                name: $name\n                earnDeductIds: $earnDeductIds\n            }\n        ) {\n            _id\n            name\n            earnDeductsCount\n        }\n    }\n\n"]))),f=Object(d["a"])(s||(s=Object(l["a"])(["\n\n    mutation(\n        $earnDeductGroupId: ID!\n        $name: String!\n        $earnDeductIds: [ID]!\n    ) {\n        updateEarnDeductGroup(\n            info: {\n                earnDeductGroupId: $earnDeductGroupId\n                name: $name\n                earnDeductIds: $earnDeductIds\n            }\n        ) {\n            _id\n            name\n            earnDeductsCount\n            earnDeductIds {\n                _id\n                name\n            }\n        }\n    }\n\n"]))),v=Object(d["a"])(c||(c=Object(l["a"])(["\n\n    mutation(\n        $earnDeductGroupId: ID!\n    ) {\n        deleteEarnDeductGroup (earnDeductGroupId: $earnDeductGroupId)\n    }\n\n"]))),b=function(){return new Promise(function(){var e=Object(o["a"])(Object(u["a"])().mark((function e(t,n){var a;return Object(u["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i["a"].query({query:p});case 3:a=e.sent,t(a.data.getEarnDeductGroups),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),n(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}())},h=function(e){return new Promise(function(){var t=Object(o["a"])(Object(u["a"])().mark((function t(n,a){var r;return Object(u["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i["a"].mutate({mutation:m,variables:e});case 3:r=t.sent,n(r.data.addEarnDeductGroup),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),a(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}())},w=function(e){return new Promise(function(){var t=Object(o["a"])(Object(u["a"])().mark((function t(n,a){var r;return Object(u["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i["a"].mutate({mutation:f,variables:e});case 3:r=t.sent,n(r.data.updateEarnDeductGroup),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),a(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}())},x=function(e){return new Promise(function(){var t=Object(o["a"])(Object(u["a"])().mark((function t(n,a){var r;return Object(u["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i["a"].mutate({mutation:v,variables:{earnDeductGroupId:e}});case 3:r=t.sent,n(r.data.deleteEarnDeductGroup),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),a(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,n){return t.apply(this,arguments)}}())}},f665:function(e,t,n){"use strict";var a=n("23e7"),r=n("2266"),s=n("59ed"),c=n("825a"),u=n("46c4");a({target:"Iterator",proto:!0,real:!0},{find:function(e){c(this),s(e);var t=u(this),n=0;return r(t,(function(t,a){if(e(t,n++))return a(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})}}]);
//# sourceMappingURL=earning.d16c6bd9.js.map